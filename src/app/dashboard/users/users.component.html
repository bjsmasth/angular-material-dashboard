<div class="container">
  <app-navbar title="Table List"></app-navbar>
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <i class="material-icons">assignment</i>
        </div>
        <div class="card-content">
          <div class="row">
            <div class="col-md-6">
              <h4 class="card-title">Users</h4>
            </div>
            <div class="col-md-6">
              <button (click)="openUserForm($event)"  md-raised-button class="btn btn-primary float-right">Add New User</button>
            </div>
          </div>

          <div class="table-responsive">
            <div class="mat-elevation-z8">
              <mat-card *ngIf="isLoading"
                        style="display: flex; justify-content: center; align-items: center">
                <mat-progress-spinner
                  [diameter]="40"
                  color="primary"
                  mode="indeterminate">
                </mat-progress-spinner>
              </mat-card>
              <table [style.visibility]="!isLoading ? 'visible' : 'hidden'" mat-table [dataSource]="listData" matSort (matSortChange)="sortData($event)">

                <ng-container matColumnDef="name" >
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Name</th>
                  <td mat-cell *matCellDef="let element"> {{element.full_name}} </td>
                </ng-container>

                <ng-container matColumnDef="username">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Username</th>
                  <td mat-cell *matCellDef="let element"> {{element.username}} </td>
                </ng-container>

                <ng-container matColumnDef="email">
                  <th mat-header-cell *matHeaderCellDef> Email</th>
                  <td mat-cell *matCellDef="let element"> {{element.email}} </td>
                </ng-container>

                <ng-container matColumnDef="role">
                  <th mat-header-cell *matHeaderCellDef> Role</th>
                  <td mat-cell *matCellDef="let element">
                    <mat-chip-list aria-label="Fish selection">
                      <mat-chip *ngFor="let role of element.roles" color="accent" selected>{{role.name | uppercase}}</mat-chip>
                    </mat-chip-list>
                  </td>
                </ng-container>

                <ng-container matColumnDef="created_date">
                  <th mat-header-cell *matHeaderCellDef> Created On</th>
                  <td mat-cell *matCellDef="let element"> {{element.created_at | date}} </td>
                </ng-container>

                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef> Status</th>
                  <td mat-cell *matCellDef="let element"> {{ element.email_verified_at | date}} </td>
                </ng-container>

                <ng-container matColumnDef="action">
                  <th mat-header-cell *matHeaderCellDef> Actions </th>
                  <td mat-cell *matCellDef="let row">
                    <button mat-icon-button color="primary" (click)="openUserForm($event, row.id)"> <mat-icon>launch</mat-icon></button>
                    <button mat-icon-button color="warn"> <mat-icon>delete</mat-icon></button>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>

              <mat-paginator
                [length]="allData?.total"
                [pageSize]="allData?.per_page"
                [pageIndex]="allData?.current_page - 1"
                [pageSizeOptions]="[10, 20, 30]"
                (page)="pageChanged($event)"
                showFirstLastButtons>
              </mat-paginator>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
